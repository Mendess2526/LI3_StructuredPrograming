\documentclass[10pt,a4paper]{report}
\usepackage[utf8]{inputenc}
\usepackage[portuguese]{babel}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{indentfirst}
\usepackage{float}
\usepackage{array}
\usepackage{multirow}
\usepackage{geometry}
\usepackage[cache=false]{minted}
\usepackage{pdflscape}
\usepackage[titletoc]{appendix}
\geometry{
 a4paper,
 top=3cm,
 bottom=2.5cm,
 left=3cm,
 right=2.5cm
}
\addto\captionsportuguese{% Replace "english" with the language you use
      \renewcommand{\contentsname}%
          {Índice}%
}
\titleformat{\chapter}{\normalfont\huge}{\thechapter.}{10pt}{\huge}
\begin{document}
\begin{titlepage}
    \center
    \vspace*{4.0cm}
    {\huge {\bf Universidade do Minho}}\\[0.4cm]
    \vspace{3.0cm}
    \textsc{\huge{Processamento de xml}}\\[0.5cm] %TODO melhorar isto
    \vspace{3.0cm}
    \textsc{\huge{Mestrado Integrado em Engenharia Informática}}\\[0.5cm]
    \vspace{2.0cm}
    \textsc{Laboratorios de Informática 3}\\[0.5cm]
    \textsc{(2º Ano, 2º Semestre, 2017/2018)}\\[0.5cm]
    \vspace{1.5cm}
    \begin{flushleft}
        A79003 \,\,\,Pedro Mendes Félix da Costa
        \vspace{0.2cm}

        A80453 \,\,\,Bárbara Andreia Cardoso Ferreira
    \end{flushleft}
        \vspace{1cm}
    \begin{flushright}
        Braga

        Abril 2018
    \end{flushright}

\end{titlepage}

\tableofcontents %TODO mudar titulo para indice default

\chapter{Introdução}
    Este trabalho tem como objetivo 

\chapter{Descrição do Problema}
    Analisando as queries decidimos que seria necessário representar
    as seguintes entidades:

    \section{Utilizadores}
    Para represantar os \textbf{users} guardamos os seguintes atributos:
    \begin{itemize}
            \item Id
            \item Biografia
            \item Nome
            \item Reputação
            \item Número de posts
            \item Lista dos posts
    \end{itemize}

    \section{Posts}
    Para represantar os \textbf{posts} dividimos os atributos por duas
     sub estruturas, cujos atributos são:
        \subsection{Questões}
        \begin{itemize}
            \item Id
            \item Score
            \item Data
            \item Título da questão
            \item Id do autor da questão
            \item Nome do autor da questão
            \item Número de respostas
            \item Lista das respostas
            \item Tags
        \end{itemize}

        \subsection{Respostas}
        \begin{itemize}
            \item Id
            \item Score
            \item Data
            \item Número de comentários
            \item Id do autor da resposta
            \item Id da questão a que responde
            \item Nome do autor da resposta
            \item Referência da questão a que responde
        \end{itemize}


\chapter{Tipo Concreto de Dados}
    Para armazenar as entidades descritas acima foi implementado um TCD que
    as armazena de diferentes formas.
    \begin{minted}{C}
struct TCD_community{
    QUESTIONS_HTABLE questions;
    ANSWERS_HTABLE answers;
    SO_USERS_HTABLE users;
    TAGS_HTABLE tags;
    CALENDARIO calendarioQuestions;
    CALENDARIO calendarioAnswers;
};
    \end{minted}
    \section{Hashtables}
        Todas as entidades são armazenadas numa hashtable pois para todas são
        necessarias pesquisas por id (ou nome no caso das tags).
        \subsection{Tags}
        A hashtable das tags serve para criar uma associação "Nome Id" visto que
        as questões guardam uma lista com os nomes das tags e para responder à
        query 11 é necessario obter os ids das mesmas.

    \section{Calendário}
        Foi pensada a utilização de arvores binarias ordenadas por data,
        mas isto foi considerado ineficiente por várias razões. Foi então,
        concebido uma estructura a qual demos o nome de \textbf{Calendário}.

        Esta estrutura permite:
        \begin{itemize}
                \item Guardar qualquer objecto desde que seja dada
                      uma passada uma data associada a mesma.
                \item Iterar sobre os objectos dado um intervalo de tempo
                      por ordem cronológica normal ou inversa, conforme a
                      ordem dos argumentos.
        \end{itemize}
        \subsection{DateTime}
        Para a implementação deste foi necessario extender o \textbf{Date} para
        incluir a hora, minuto, segundo e milissegundo do post.
    \begin{minted}{C}
struct _dateTime{
    int year;
    int month;
    int day;
    int hours;
    int minutos;
    int seconds;
    int milisseconds;
};
    \end{minted}

\chapter{Modularização Funcional}
    Para aceder aos dados da estrutura principal foi definida uma api simples
    que permite pesquisas de Utilizadores e posts por id,
    \begin{minted}{C}
QUESTION community_get_question(TAD_community com, long id);
ANSWER community_get_answer(TAD_community com, long id);
SO_USER community_get_user(TAD_community com, long id);
    \end{minted}
    pesquisas do id das tags dado o nome,
    \begin{minted}{C}
long community_get_tag_id(TAD_community com, xmlChar* tag);
    \end{minted}
    obter listas ordenadas dos utilizadores
    \begin{minted}{C}
USERS community_get_sorted_user_list(TAD_community com, ComCmpFunc cfunc, int N);
    \end{minted}
    e obter questões ou respostas dentro de intervalos de tempo,
    ordenadas cronológicamente.
    \begin{minted}{C}
void community_iterate_questions(TAD_community com, DATETIME from, DATETIME to,
                                    void* data, CFunc calFunc);
void community_iterate_answers(TAD_community com, DATETIME from, DATETIME to,
                                    void* data, CFunc calFunc);
    \end{minted}

\chapter{Resolução das queries}
    
\chapter{Conclusões e Trabalho Futuro}


\end{document}
